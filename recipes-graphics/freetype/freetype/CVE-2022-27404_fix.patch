Date: Thu 09 Feb 2023
From: sroy040 <surajeet_roy@comcast.com>
Subject: Patch selected CVEs for the multiple component listed
Source: COMCAST
Signed-off-by: sroy040 <surajeet_roy@comcast.com>
Index: freetype/src/sfnt/sfobjs.c
===================================================================
--- freetype.orig/src/sfnt/sfobjs.c
+++ freetype/src/sfnt/sfobjs.c
@@ -554,7 +554,7 @@
     face_index = FT_ABS( face_instance_index ) & 0xFFFF;

     /* value -(N+1) requests information on index N */
-    if ( face_instance_index < 0 )
+    if ( face_instance_index < 0 && face_index > 0 )
       face_index--;

     if ( face_index >= face->ttc_header.count )
Index: freetype/src/sfnt/sfwoff2.c
===================================================================
--- freetype.orig/src/sfnt/sfwoff2.c
+++ freetype/src/sfnt/sfwoff2.c
@@ -2089,7 +2089,7 @@
     /* Validate requested face index. */
     *num_faces = woff2.num_fonts;
     /* value -(N+1) requests information on index N */
-    if ( *face_instance_index < 0 )
+    if ( *face_instance_index < 0 && face_index > 0 )
       face_index--;

     if ( face_index >= woff2.num_fonts )
