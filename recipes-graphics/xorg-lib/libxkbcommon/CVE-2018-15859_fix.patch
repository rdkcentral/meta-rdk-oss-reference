Date: Dec 2, 2023
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        https://github.com/xkbcommon/libxkbcommon/commit/bb4909d2d8fa6b08155e449986a478101e2b2634
Index: libxkbcommon-0.5.0/src/xkbcomp/expr.c
===================================================================
--- libxkbcommon-0.5.0.orig/src/xkbcomp/expr.c
+++ libxkbcommon-0.5.0/src/xkbcomp/expr.c
@@ -47,11 +47,15 @@ ExprResolveLhs(struct xkb_context *ctx,
         *elem_rtrn = xkb_atom_text(ctx, expr->field_ref.element);
         *field_rtrn = xkb_atom_text(ctx, expr->field_ref.field);
         *index_rtrn = NULL;
-        return true;
+        return (*elem_rtrn != NULL && *field_rtrn != NULL);
     case EXPR_ARRAY_REF:
         *elem_rtrn = xkb_atom_text(ctx, expr->array_ref.element);
         *field_rtrn = xkb_atom_text(ctx, expr->array_ref.field);
         *index_rtrn = expr->array_ref.entry;
+        if (expr->array_ref.element != XKB_ATOM_NONE && *elem_rtrn == NULL)
+            return false;
+        if (*field_rtrn == NULL)
+            return false;
         return true;
     default:
         break;
