Date: Nov 30, 2023
From: 656cb0450aeb73b25d7d26980af342b37ac4c568
Subject: Patch ffmpeg to address CVE-2022-3109
Source:  Github  https://github.com/FFmpeg/FFmpeg/commit/656cb0450aeb73b25d7d26980af342b37ac4c568
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: ffmpeg-4.2.2/libavcodec/vp3.c
===================================================================
--- ffmpeg-4.2.2.orig/libavcodec/vp3.c
+++ ffmpeg-4.2.2/libavcodec/vp3.c
@@ -2740,8 +2740,13 @@ static int vp3_decode_frame(AVCodecConte
     if (ff_thread_get_buffer(avctx, &s->current_frame, AV_GET_BUFFER_FLAG_REF) < 0)
         goto error;
 
-    if (!s->edge_emu_buffer)
+    if (!s->edge_emu_buffer) {
         s->edge_emu_buffer = av_malloc(9 * FFABS(s->current_frame.f->linesize[0]));
+        if (!s->edge_emu_buffer) {
+            ret = AVERROR(ENOMEM);
+            goto error;
+	}
+    }
 
     if (s->keyframe) {
         if (!s->theora) {
