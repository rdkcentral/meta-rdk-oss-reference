Date: Nov 30, 2023
From: 757da974b21833529cc41bdcc9684c29660cdfa8
Subject: Patch ffmpeg to address CVE-2022-1475
Source:  git.videolan.org  http://git.videolan.org/?p=ffmpeg.git;a=commitdiff;h=757da974b21833529cc41bdcc9684c29660cdfa8
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: ffmpeg-4.2.2/libavcodec/g729_parser.c
===================================================================
--- ffmpeg-4.2.2.orig/libavcodec/g729_parser.c
+++ ffmpeg-4.2.2/libavcodec/g729_parser.c
@@ -48,6 +48,9 @@ static int g729_parse(AVCodecParserConte
         av_assert1(avctx->codec_id == AV_CODEC_ID_G729);
         /* FIXME: replace this heuristic block_size with more precise estimate */
         s->block_size = (avctx->bit_rate < 8000) ? G729D_6K4_BLOCK_SIZE : G729_8K_BLOCK_SIZE;
+        // channels > 2 is invalid, we pass the packet on unchanged
+        if (avctx->channels > 2)
+            s->block_size = 0;
         s->block_size *= avctx->channels;
         s->duration   = avctx->frame_size;
     }
