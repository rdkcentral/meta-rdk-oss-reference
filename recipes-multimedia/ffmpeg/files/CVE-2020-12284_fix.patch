Date: Nov 30, 2023
From: 1812352d767ccf5431aa440123e2e260a4db2726
Subject: Patch ffmpeg to address CVE-2020-12284
Source:  Github  https://github.com/FFmpeg/FFmpeg/commit/1812352d767ccf5431aa440123e2e260a4db2726
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: ffmpeg-4.2.2/libavcodec/cbs_jpeg.c
===================================================================
--- ffmpeg-4.2.2.orig/libavcodec/cbs_jpeg.c
+++ ffmpeg-4.2.2/libavcodec/cbs_jpeg.c
@@ -197,6 +197,9 @@ static int cbs_jpeg_split_fragment(Coded
         if (marker == JPEG_MARKER_SOS) {
             length = AV_RB16(frag->data + start);
 
+            if (length > end - start)
+                return AVERROR_INVALIDDATA;
+
             data_ref = NULL;
             data     = av_malloc(end - start +
                                  AV_INPUT_BUFFER_PADDING_SIZE);
