Date: Wed, 22 Mar 2023 16:33:09 +0000
From: Aravindan NarasimhapuramChakravarthy <aravindan_narasimhapuramchakravarthy@comcast.com>
Subject: CVE-2022-2868 Recreated from https://gerrit.teamccp.com/#/c/700748/
Source: https://gitlab.com/libtiff/libtiff/-/merge_requests/294/diffs?commit_id=b258ed69a485a9cfb299d9f060eb2a46c54e5903 f178decc069c9847108ee861b4065c36694b9101 Mon Sep 17 00:00:00 2001
Signed-off-by:  Su Laus / anaras440(aravindan_narasimhapuramchakravarthy@comcast.com)
---

Index: tiff-4.3.0/tools/tiffcrop.c
===================================================================
--- tiff-4.3.0.orig/tools/tiffcrop.c
+++ tiff-4.3.0/tools/tiffcrop.c
@@ -5382,6 +5382,7 @@ computeInputPixelOffsets(struct crop_mas
                "Invalid left/right margins and /or image crop width requested");
     return (-1);
     }
+  crop_width  = endx - startx + 1;
   if (crop_width > image->width)
     crop_width = image->width;
 
@@ -5391,6 +5392,7 @@ computeInputPixelOffsets(struct crop_mas
               "Invalid top/bottom margins and /or image crop length requested");
     return (-1);
     }
+  crop_length = endy - starty + 1;
   if (crop_length > image->length)
     crop_length = image->length;
 
