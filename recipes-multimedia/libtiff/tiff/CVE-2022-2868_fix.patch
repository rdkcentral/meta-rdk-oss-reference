From f178decc069c9847108ee861b4065c36694b9101 Mon Sep 17 00:00:00 2001
From: NareshKumar M <NareshKumar_M@comcast.com>
Date: Mon, 31 Oct 2022 10:41:09 +0000
Subject: [PATCH] Date: Feb 6, 2022 From:
 b258ed69a485a9cfb299d9f060eb2a46c54e5903 Subject: CVE-2022-2868 Source:
 https://gitlab.com/libtiff/libtiff/-/merge_requests/294/diffs?commit_id=b258ed69a485a9cfb299d9f060eb2a46c54e5903
 License: GPLV2 Upstream-Status:
 https://gitlab.com/libtiff/libtiff/-/merge_requests/294/diffs?commit_id=b258ed69a485a9cfb299d9f060eb2a46c54e5903
 Signed-off-by:  Su Laus / nm296(nareshkumar_m@comcast.com)

---
 tools/tiffcrop.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/tools/tiffcrop.c b/tools/tiffcrop.c
index b60b774..aca4690 100644
--- a/tools/tiffcrop.c
+++ b/tools/tiffcrop.c
@@ -5343,6 +5343,7 @@ computeInputPixelOffsets(struct crop_mask *crop, struct image_data *image,
                "Invalid left/right margins and /or image crop width requested");
     return (-1);
     }
+  crop_width  = endx - startx + 1;
   if (crop_width > image->width)
     crop_width = image->width;
 
@@ -5352,6 +5353,7 @@ computeInputPixelOffsets(struct crop_mask *crop, struct image_data *image,
               "Invalid top/bottom margins and /or image crop length requested");
     return (-1);
     }
+  crop_length = endy - starty + 1;
   if (crop_length > image->length)
     crop_length = image->length;
 
