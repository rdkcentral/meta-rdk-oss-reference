From c78cce5388fa1190bc20295a00725428cd75014d Mon Sep 17 00:00:00 2001
From: skondu363 <Srihariraghava_konduritirumala@comcast.com>
Date: Mon, 11 Nov 2024 07:49:19 +0000
Subject: [PATCH]
Source: upstream
        https://github.com/systemd/systemd/commit/9102c625a673a3246d7e73d8737f3494446bad4e
CVE: CVE-2022-3821

Signed-off-by: skondu363 <Srihariraghava_konduritirumala@comcast.com>
---
 src/basic/time-util.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/basic/time-util.c b/src/basic/time-util.c
index edd9179cb8..816800116d 100644
--- a/src/basic/time-util.c
+++ b/src/basic/time-util.c
@@ -413,7 +413,7 @@ char *format_timespan(char *buf, size_t l, usec_t t, usec_t accuracy) {
                         t = b;
                 }

-                n = MIN((size_t) k, l);
+                n = MIN((size_t) k, l-1);

                 l -= n;
                 p += n;
