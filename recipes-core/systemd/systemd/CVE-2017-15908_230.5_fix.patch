From ec1921a57076022961311a68c21b7f22bda7d691 Mon Sep 17 00:00:00 2001
From: skondu363 <Srihariraghava_konduritirumala@comcast.com>
Date: Mon, 7 Oct 2024 07:18:59 +0000
Subject: [PATCH]
Date: September 07, 2024
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        [https://github.com/systemd/systemd/pull/7184/files]
CVE : CVE-2017-15908

Signed-off-by: skondu363 <Srihariraghava_konduritirumala@comcast.com>
---
 src/resolve/resolved-dns-packet.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/src/resolve/resolved-dns-packet.c b/src/resolve/resolved-dns-packet.c
index fc9f6451f5..326784694d 100644
--- a/src/resolve/resolved-dns-packet.c
+++ b/src/resolve/resolved-dns-packet.c
@@ -1454,7 +1454,7 @@ static int dns_packet_read_type_window(DnsPacket *p, Bitmap **types, size_t *sta
 
                 found = true;
 
-                while (bitmask) {
+		for (; bitmask; bit++, bitmask >>= 1)
                         if (bitmap[i] & bitmask) {
                                 uint16_t n;
 
@@ -1469,8 +1469,6 @@ static int dns_packet_read_type_window(DnsPacket *p, Bitmap **types, size_t *sta
                                         return r;
                         }
 
-                        bit++;
-                        bitmask >>= 1;
                 }
         }
 
