From 7049dbf0ad7d0aed33c123eb9fe74ee222cdf354 Mon Sep 17 00:00:00 2001
From: Goutam Damodaran <Goutam_Damodaran@Comcast.com>
Date: Thu, 27 Feb 2020 11:47:00 +0000
Subject: [PATCH] extenstions http
Source: COMCAST
License: GPLV2
Upstream-Status: Pending
Signed-off-by: Goutam Damodaran <Goutam_Damodaran@Comcast.com>
---
 extensions/libxt_httpcookie.c | 11 ++++++++++-
 extensions/libxt_httphost.c   | 14 +++++++++++++-
 extensions/libxt_httpurl.c    | 14 +++++++++++++-
 3 files changed, 36 insertions(+), 3 deletions(-)

diff --git a/extensions/libxt_httpcookie.c b/extensions/libxt_httpcookie.c
index 2db9f95..4486b73 100644
--- a/extensions/libxt_httpcookie.c
+++ b/extensions/libxt_httpcookie.c
@@ -18,7 +18,16 @@
 #include <ctype.h>
 #include <xtables.h>
 #include <stddef.h>
-#include <linux/netfilter/xt_httpcookie.h>
+
+#ifndef _XT_HTTPCOOKIE_H
+#define _XT_HTTPCOOKIE_H
+
+struct xt_httpcookie_info
+{
+        u_int8_t block_cookies;
+};
+
+#endif /*_XT_HTTPCOOKIE_H */
 
 static void help(void)
 {
diff --git a/extensions/libxt_httphost.c b/extensions/libxt_httphost.c
index c22b6c3..3cfbb38 100644
--- a/extensions/libxt_httphost.c
+++ b/extensions/libxt_httphost.c
@@ -18,7 +18,19 @@
 #include <ctype.h>
 #include <xtables.h>
 #include <stddef.h>
-#include <linux/netfilter/xt_httphost.h>
+
+#ifndef _XT_HTTPHOST_H
+#define _XT_HTTPHOST_H
+
+#define XT_HTTPHOST_MAX_HOST_SIZE (128)
+
+struct xt_httphost_info
+{
+        char      host[XT_HTTPHOST_MAX_HOST_SIZE];
+        u_int8_t  invert;
+};
+
+#endif /*_XT_HTTPHOST_H */
 
 static void help(void)
 {
diff --git a/extensions/libxt_httpurl.c b/extensions/libxt_httpurl.c
index e9cfa26..c7840fe 100644
--- a/extensions/libxt_httpurl.c
+++ b/extensions/libxt_httpurl.c
@@ -18,7 +18,19 @@
 #include <ctype.h>
 #include <xtables.h>
 #include <stddef.h>
-#include <linux/netfilter/xt_httpurl.h>
+
+#ifndef _XT_HTTPURL_H
+#define _XT_HTTPURL_H
+
+struct xt_httpurl_info
+{
+        u_int8_t  match_proxy;
+        u_int8_t  match_java;
+        u_int8_t  match_activex;
+        u_int8_t  invert;
+};
+
+#endif /*_XT_HTTPURL_H */
 
 static void help(void)
 {
