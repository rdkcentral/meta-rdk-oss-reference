Date: 27-April-2023
From: Kalidoss_Marimuthu@comcast.com
Source: Backport

See https://chromium.googlesource.com/webm/libwebp/+log/be738c6d396fa5a272c1b209be4379a7532debfe..29fb8562c60b5a919a75d904ff7366af423f8ab9?pretty=fuller&n=10000

Index: libwebp-0.5.0/src/mux/muxread.c
===================================================================
--- libwebp-0.5.0.orig/src/mux/muxread.c
+++ libwebp-0.5.0/src/mux/muxread.c
@@ -139,6 +139,7 @@ static int MuxImageParse(const WebPChunk
         wpi->is_partial_ = 1;  // Waiting for a VP8 chunk.
         break;
       case WEBP_CHUNK_IMAGE:
+	if (wpi->img_ != NULL) goto Fail;  // Only 1 image chunk allowed.
         if (ChunkSetNth(&subchunk, &wpi->img_, 1) != WEBP_MUX_OK) goto Fail;
         if (!MuxImageFinalize(wpi)) goto Fail;
         wpi->is_partial_ = 0;  // wpi is completely filled.
