Date: 27-April-2023
From: Kalidoss_Marimuthu@comcast.com
Source: Backport

See https://chromium.googlesource.com/webm/libwebp/+/1344a2e947c749d231141a295327e5b99b444d63

Index: libwebp-0.5.0/src/utils/quant_levels_dec.c
===================================================================
--- libwebp-0.5.0.orig/src/utils/quant_levels_dec.c
+++ libwebp-0.5.0/src/utils/quant_levels_dec.c
@@ -255,9 +255,14 @@ static void CleanupParams(SmoothParams*
 
 int WebPDequantizeLevels(uint8_t* const data, int width, int height,
                          int strength) {
-  const int radius = 4 * strength / 100;
+  int radius = 4 * strength / 100;
   if (strength < 0 || strength > 100) return 0;
   if (data == NULL || width <= 0 || height <= 0) return 0;  // bad params
+
+  // limit the filter size to not exceed the image dimensions
+  if (2 * radius + 1 > width) radius = (width - 1) >> 1;
+  if (2 * radius + 1 > height) radius = (height - 1) >> 1;
+
   if (radius > 0) {
     SmoothParams p;
     memset(&p, 0, sizeof(p));
