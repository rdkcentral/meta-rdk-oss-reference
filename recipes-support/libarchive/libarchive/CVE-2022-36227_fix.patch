Date: Aug 28, 2023
From: RevathiBhavani_Alluri@comcast.com
Source: upstream
        https://github.com/libarchive/libarchive/commit/fd180c36036df7181a64931264732a10ad8cd024
Index: git/libarchive/archive_write.c
===================================================================
--- git.orig/libarchive/archive_write.c
+++ git/libarchive/archive_write.c
@@ -201,6 +201,10 @@ __archive_write_allocate_filter(struct a
 	struct archive_write_filter *f;
 
 	f = calloc(1, sizeof(*f));
+    
+    if (f == NULL)
+        return (NULL);
+
 	f->archive = _a;
 	f->state = ARCHIVE_WRITE_FILTER_STATE_NEW;
 	if (a->filter_first == NULL)
@@ -548,6 +552,10 @@ archive_write_open2(struct archive *_a,
 	a->client_data = client_data;
 
 	client_filter = __archive_write_allocate_filter(_a);
+
+    if (client_filter == NULL)
+        return (ARCHIVE_FATAL);
+
 	client_filter->open = archive_write_client_open;
 	client_filter->write = archive_write_client_write;
 	client_filter->close = archive_write_client_close;
