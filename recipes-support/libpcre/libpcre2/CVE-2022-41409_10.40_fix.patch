Subject: [PATCH]
Date: July 01, 2024
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        https://github.com/PCRE2Project/pcre2/commit/94e1c001761373b7d9450768aa15d04c25547a35

Signed-off-by: skondu363 <Srihariraghava_konduritirumala@comcast.com>
---
 src/pcre2test.c      | 4 ++--
 testdata/testinput2  | 3 +++
 testdata/testoutput2 | 4 ++++
 3 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/src/pcre2test.c b/src/pcre2test.c
index ea52a20..378529a 100644
--- a/src/pcre2test.c
+++ b/src/pcre2test.c
@@ -6781,9 +6781,9 @@ while ((c = *p++) != 0)
       }
 
     i = (int32_t)li;
-    if (i-- == 0)
+    if (i-- <= 0)
       {
-      fprintf(outfile, "** Zero repeat not allowed\n");
+      fprintf(outfile, "** Zero or negative repeat not allowed\n");
       return PR_OK;
       }
 
diff --git a/testdata/testinput2 b/testdata/testinput2
index d37d8f3..717ba2a 100644
--- a/testdata/testinput2
+++ b/testdata/testinput2
@@ -5932,4 +5932,7 @@ a)"xI
 /[Aa]{2,3}/BI
     aabcd
 
+--
+    \[X]{-10}
+
 # End of testinput2
diff --git a/testdata/testoutput2 b/testdata/testoutput2
index ce090f8..d2188d3 100644
--- a/testdata/testoutput2
+++ b/testdata/testoutput2
@@ -17746,6 +17746,10 @@ Subject length lower bound = 2
     aabcd
  0: aa
 
+--
+    \[X]{-10}
+** Zero or negative repeat not allowed
+
 # End of testinput2
 Error -70: PCRE2_ERROR_BADDATA (unknown error number)
 Error -62: bad serialized data
