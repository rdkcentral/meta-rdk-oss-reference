Subject: [PATCH]
Date: July 01, 2024
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        https://github.com/michael-methner/dlt-daemon/commit/8ac9a080bee25e67e49bd138d81c992ce7b6d899

Signed-off-by: skondu363 <Srihariraghava_konduritirumala@comcast.com>
---
 src/shared/dlt_common.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/shared/dlt_common.c b/src/shared/dlt_common.c
index 427044b..8e4310b 100644
--- a/src/shared/dlt_common.c
+++ b/src/shared/dlt_common.c
@@ -1707,7 +1707,7 @@ DltReturnValue dlt_file_message(DltFile *file, int index, int verbose)
         return DLT_RETURN_WRONG_PARAMETER;
 
     /* check if message is in range */
-    if (index >= file->counter) {
+    if (index < 0 || index >= file->counter) {
         dlt_vlog(LOG_WARNING, "Message %d out of range!\r\n", index);
         return DLT_RETURN_WRONG_PARAMETER;
     }
