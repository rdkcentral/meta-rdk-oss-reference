From 7ecd085e8195f88fd3632686bf1f7930dad8cf5a Mon Sep 17 00:00:00 2001
From: kkanag314 <krishnapriya_kanagaraj@comcast.com>
Date: Tue, 19 Mar 2024 13:28:55 +0000
Subject: [PATCH] set same_site_policy to NONE if COL_SAME_SITE_POLICY is
 NULL_3.0

---
 libsoup/cookies/soup-cookie-jar-db.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/libsoup/cookies/soup-cookie-jar-db.c b/libsoup/cookies/soup-cookie-jar-db.c
index 91fa15d3..895eb1e4 100644
--- a/libsoup/cookies/soup-cookie-jar-db.c
+++ b/libsoup/cookies/soup-cookie-jar-db.c
@@ -186,7 +186,13 @@ callback (void *data, int argc, char **argv, char **colname)
 
 	http_only = (g_strcmp0 (argv[COL_HTTP_ONLY], "1") == 0);
 	secure = (g_strcmp0 (argv[COL_SECURE], "1") == 0);
-	same_site_policy = g_ascii_strtoll (argv[COL_SAME_SITE_POLICY], NULL, 0);
+
+       //set same_site_policy to NONE if argv[COL_SAME_SITE_POLICY] is NULL
+       if (argv[COL_SAME_SITE_POLICY] == NULL) {
+           same_site_policy = SOUP_SAME_SITE_POLICY_NONE;
+       } else {
+            same_site_policy = g_ascii_strtoll (argv[COL_SAME_SITE_POLICY], NULL, 0);
+       }
 
 	cookie = soup_cookie_new (name, value, host, path, max_age);
 
-- 
2.25.1

