Subject: [PATCH] 
Date: May 6, 2024 
From: srihariraghava_konduritirumala@comcast.com
Source: upstream
        https://downloads.isc.org/isc/bind9/9.18.19/patches/0002-CVE-2023-4236.patch

Signed-off-by: skondu363 <Srihariraghava_konduritirumala@comcast.com>
---
 lib/isc/netmgr/tlsdns.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/lib/isc/netmgr/tlsdns.c b/lib/isc/netmgr/tlsdns.c
index e099a62..01cc6b0 100644
--- a/lib/isc/netmgr/tlsdns.c
+++ b/lib/isc/netmgr/tlsdns.c
@@ -1813,9 +1813,11 @@ tlsdns_send_direct(isc_nmsocket_t *sock, isc__nm_uvreq_t *req) {
 	}
 
 	result = tls_cycle(sock);
+        if (result != ISC_R_SUCCESS) {
+		return (result);
+	}
 
 requeue:
-
 	tlsdns_send_enqueue(sock, req);
 
 	return (result);
