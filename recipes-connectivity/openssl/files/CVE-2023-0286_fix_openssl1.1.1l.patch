Index: openssl/crypto/x509v3/v3_genn.c
===================================================================
--- openssl.orig/crypto/x509v3/v3_genn.c
+++ openssl/crypto/x509v3/v3_genn.c
@@ -98,8 +98,8 @@ int GENERAL_NAME_cmp(GENERAL_NAME *a, GE
         return -1;
     switch (a->type) {
     case GEN_X400:
-        result = ASN1_TYPE_cmp(a->d.x400Address, b->d.x400Address);
-        break;
+        result = ASN1_STRING_cmp(a->d.x400Address, b->d.x400Address);
+	break;
 
     case GEN_EDIPARTY:
         result = edipartyname_cmp(a->d.ediPartyName, b->d.ediPartyName);
Index: openssl/include/openssl/x509v3.h
===================================================================
--- openssl.orig/include/openssl/x509v3.h
+++ openssl/include/openssl/x509v3.h
@@ -136,8 +136,8 @@ typedef struct GENERAL_NAME_st {
         OTHERNAME *otherName;   /* otherName */
         ASN1_IA5STRING *rfc822Name;
         ASN1_IA5STRING *dNSName;
-        ASN1_TYPE *x400Address;
-        X509_NAME *directoryName;
+        ASN1_STRING *x400Address;
+	X509_NAME *directoryName;
         EDIPARTYNAME *ediPartyName;
         ASN1_IA5STRING *uniformResourceIdentifier;
         ASN1_OCTET_STRING *iPAddress;
Index: openssl/test/v3nametest.c
===================================================================
--- openssl.orig/test/v3nametest.c
+++ openssl/test/v3nametest.c
@@ -646,6 +646,14 @@ static struct gennamedata {
             0xb7, 0x09, 0x02, 0x02
         },
         15
+    }, {
+        /*
+         * Regression test for CVE-2023-0286.
+         */
+        {
+            0xa3, 0x00
+        },
+        2
     }
 };
 
