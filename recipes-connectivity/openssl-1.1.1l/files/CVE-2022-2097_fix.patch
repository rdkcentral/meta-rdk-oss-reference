Date: Jan 13, 2023
From: sroy040 <surajeet_roy@comcast.com>
Source: COMCAST
Subject: Patch selected CVEs for the openssl component listed
Signed-off-by: sroy040 <surajeet_roy@comcast.com>
Index: openssl-1.1.1l/crypto/aes/asm/aesni-x86.pl
===================================================================
--- openssl-1.1.1l.orig/crypto/aes/asm/aesni-x86.pl
+++ openssl-1.1.1l/crypto/aes/asm/aesni-x86.pl
@@ -2027,7 +2027,7 @@ my ($l_,$block,$i1,$i3,$i5) = ($rounds_,
 	&movdqu		(&QWP(-16*2,$out,$inp),$inout4);
 	&movdqu		(&QWP(-16*1,$out,$inp),$inout5);
 	&cmp		($inp,$len);			# done yet?
-	&jb		(&label("grandloop"));
+	&jbe            (&label("grandloop"));
 
 &set_label("short");
 	&add		($len,16*6);
@@ -2453,7 +2453,7 @@ my ($l_,$block,$i1,$i3,$i5) = ($rounds_,
 	&pxor		($rndkey1,$inout5);
 	&movdqu		(&QWP(-16*1,$out,$inp),$inout5);
 	&cmp		($inp,$len);			# done yet?
-	&jb		(&label("grandloop"));
+	&jbe            (&label("grandloop"));
 
 &set_label("short");
 	&add		($len,16*6);
