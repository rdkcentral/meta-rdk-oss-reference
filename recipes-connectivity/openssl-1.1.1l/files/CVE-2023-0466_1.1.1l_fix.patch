Date: Sep 4, 2023
From: RevathiBhavani_Alluri@comcast.com
Source: upstream 
        https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=0d16b7e99aafc0b4a6d729eec65a411a7e025f0a
Fix documentation of X509_VERIFY_PARAM_add0_policy()

author        Tomas Mraz <tomas@openssl.org>
              Tue, 21 Mar 2023 20:45:47 +0530 (16:15 +0100)
committer     Tomas Mraz <tomas@openssl.org>
              Tue, 28 Mar 2023 17:43:38 +0530 (14:13 +0200)

The function was incorrectly documented as enabling policy checking.

Fixes: CVE-2023-0466

Reviewed-by: Matt Caswell <matt@openssl.org>
Reviewed-by: Paul Dale <pauli@openssl.org>
(Merged from https://github.com/openssl/openssl/pull/20564)

    CHANGES.md
    NEWS.md
    doc/man3/X509_VERIFY_PARAM_set_flags.pod
---
Index: openssl-1.1.1l/CHANGES
===================================================================
--- openssl-1.1.1l.orig/CHANGES
+++ openssl-1.1.1l/CHANGES
@@ -9,6 +9,11 @@
 
  Changes between 1.1.1k and 1.1.1l [24 Aug 2021]
 
+  *) Corrected documentation of X509_VERIFY_PARAM_add0_policy() to mention
+     that it does not enable policy checking. Thanks to
+     David Benjamin for discovering this issue. (CVE-2023-0466)
+     [Tomas Mraz]
+
   *) Fixed an SM2 Decryption Buffer Overflow.
 
      In order to decrypt SM2 encrypted data an application is expected to call the
Index: openssl-1.1.1l/doc/man3/X509_VERIFY_PARAM_set_flags.pod
===================================================================
--- openssl-1.1.1l.orig/doc/man3/X509_VERIFY_PARAM_set_flags.pod
+++ openssl-1.1.1l/doc/man3/X509_VERIFY_PARAM_set_flags.pod
@@ -92,8 +92,9 @@ B<trust>.
 X509_VERIFY_PARAM_set_time() sets the verification time in B<param> to
 B<t>. Normally the current time is used.
 
-X509_VERIFY_PARAM_add0_policy() enables policy checking (it is disabled
-by default) and adds B<policy> to the acceptable policy set.
+X509_VERIFY_PARAM_add0_policy() adds B<policy> to the acceptable policy set.
+Contrary to preexisting documentation of this function it does not enable
+policy checking.
 
 X509_VERIFY_PARAM_set1_policies() enables policy checking (it is disabled
 by default) and sets the acceptable policy set to B<policies>. Any existing
@@ -377,6 +378,10 @@ and has no effect.
 
 The X509_VERIFY_PARAM_get_hostflags() function was added in OpenSSL 1.1.0i.
 
+The function X509_VERIFY_PARAM_add0_policy() was historically documented as
+enabling policy checking however the implementation has never done this.
+The documentation was changed to align with the implementation.
+
 =head1 COPYRIGHT
 
 Copyright 2009-2020 The OpenSSL Project Authors. All Rights Reserved.
Index: openssl-1.1.1l/NEWS
===================================================================
--- openssl-1.1.1l.orig/NEWS
+++ openssl-1.1.1l/NEWS
@@ -7,6 +7,7 @@
 
   Major changes between OpenSSL 1.1.1k and OpenSSL 1.1.1l [24 Aug 2021]
 
+      o Fixed documentation of X509_VERIFY_PARAM_add0_policy() (CVE-2023-0466)
       o Fixed an SM2 Decryption Buffer Overflow (CVE-2021-3711)
       o Fixed various read buffer overruns processing ASN.1 strings (CVE-2021-3712)
 
