Date: Mar 8, 2024
From: Srikanth Simgamsetti <srikanth_simgamsetti@comcast.com>
Source: COMCAST
Subject: security vulnerability CVE-2023-45866 fix for 5.48, 5.54 and 5.66
Signed-off-by: Srikanth Simgamsetti <srikanth_simgamsetti@comcast.com>
Index: bluez-5.66/profiles/input/device.c
===================================================================
--- bluez-5.66.orig/profiles/input/device.c
+++ bluez-5.66/profiles/input/device.c
@@ -85,7 +85,7 @@ struct input_device {

 static int idle_timeout = 0;
 static bool uhid_enabled = false;
-static bool classic_bonded_only = false;
+static bool classic_bonded_only = true;

 void input_set_idle_timeout(int timeout)
 {
Index: bluez-5.66/profiles/input/input.conf
===================================================================
--- bluez-5.66.orig/profiles/input/input.conf
+++ bluez-5.66/profiles/input/input.conf
@@ -17,7 +17,7 @@
 # platforms may want to make sure that input connections only come from bonded
 # device connections. Several older mice have been known for not supporting
 # pairing/encryption.
-# Defaults to false to maximize device compatibility.
+# Defaults to true for security.
 #ClassicBondedOnly=true

 # LE upgrade security
