Date: Sep 01, 2023
From: e2b0f0d8d63e1223bb714a9efb37e2257818268b
Subject: Patch bluez5 to address CVE-2022-39176
Source:  kernel.org https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/?id=e2b0f0d8d63e1223bb714a9efb37e2257818268b
License:
Upstream-Status: Pending
Signed-off-by: kmarim851 <Kalidoss_Marimuthu@comcast.com>
---
Index: bluez-5.48/profiles/audio/avrcp.c
===================================================================
--- bluez-5.48.orig/profiles/audio/avrcp.c
+++ bluez-5.48/profiles/audio/avrcp.c
@@ -1858,6 +1858,14 @@ static size_t handle_vendordep_pdu(struc
 		pdu->params_len = operand_count;
 	}
 
+	operands += sizeof(*pdu);
+	operand_count -= sizeof(*pdu);
+
+	if (ntohs(pdu->params_len) != operand_count) {
+		DBG("AVRCP PDU parameters length don't match");
+		pdu->params_len = htons(operand_count);
+	}
+
 	for (handler = session->control_handlers; handler->pdu_id; handler++) {
 		if (handler->pdu_id == pdu->pdu_id)
 			break;
