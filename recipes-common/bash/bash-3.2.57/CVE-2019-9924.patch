Subject: CVE-2019-9924

Description: rbash in Bash before 4.4-beta2 did not prevent the shell user from modifying BASH_CMDS,
thus allowing the user to execute any command with the permissions of the shell.

Backported from bash-4.4 (a5761697c9fbe8b670edc812231f44364ce64c33)
Authored and Committed by Centos_rcm
---


Index: bash-3.2.57/variables.c
===================================================================
--- bash-3.2.57.orig/variables.c
+++ bash-3.2.57/variables.c
@@ -1787,6 +1787,9 @@ make_new_variable (name, table)
   SHELL_VAR *entry;
   BUCKET_CONTENTS *elt;
 
+  if (strstr(name, "/") != NULL)
+    return NULL;
+
   entry = new_shell_variable (name);
 
   /* Make sure we have a shell_variables hash table to add to. */

