Index: lighttpd/src/mod_extforward.c
===================================================================
--- lighttpd.orig/src/mod_extforward.c
+++ lighttpd/src/mod_extforward.c
@@ -673,8 +673,8 @@ static handler_t mod_extforward_Forwarde
         while (s[i] == ' ' || s[i] == '\t') ++i;
         if (s[i] == ';') { ++i; continue; }
         if (s[i] == ',') {
-            if (j >= (int)(sizeof(offsets)/sizeof(int))) break;
-            offsets[++j] = -1; /*("offset" separating params from next proxy)*/
+            if (j >= (int)((sizeof(offsets)/sizeof(int)) - 1)) break;
+	    offsets[++j] = -1; /*("offset" separating params from next proxy)*/
             ++i;
             continue;
         }
