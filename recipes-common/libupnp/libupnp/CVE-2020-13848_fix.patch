Date: Jun 14, 2020 
From: c805c1de1141cb22f74c0d94dd5664bda37398e0
Subject: Patch libupnp to address CVE-2020-13848
Source: GITHUB GITHUB https://github.com/pupnp/pupnp/commit/c805c1de1141cb22f74c0d94dd5664bda37398e0#
License: GPLV2
Upstream-Status: Pending 
Signed-off-by: sroy040 <surajeet_roy@comcast.com>
Index: libupnp-1.6.22/upnp/src/genlib/service_table/service_table.c
===================================================================
--- libupnp-1.6.22.orig/upnp/src/genlib/service_table/service_table.c
+++ libupnp-1.6.22/upnp/src/genlib/service_table/service_table.c
@@ -299,12 +299,11 @@ FindServiceEventURLPath( service_table *
     uri_type parsed_url;
     uri_type parsed_url_in;
 
-    if( ( table )
-        &&
-        ( parse_uri( eventURLPath,
-                     strlen( eventURLPath ),
-                     &parsed_url_in ) == HTTP_SUCCESS ) ) {
-
+    if (!table || !eventURLPath) {
+	    return NULL;
+    }
+    if (parse_uri(eventURLPath, strlen(eventURLPath), &parsed_url_in) ==
+		    HTTP_SUCCESS) {
         finger = table->serviceList;
         while( finger ) {
             if( finger->eventURL )
@@ -351,11 +350,11 @@ FindServiceControlURLPath( service_table
     uri_type parsed_url;
     uri_type parsed_url_in;
 
-    if( ( table )
-        &&
-        ( parse_uri
-          ( controlURLPath, strlen( controlURLPath ),
-            &parsed_url_in ) == HTTP_SUCCESS ) ) {
+    if (!table || !controlURLPath) {
+	    return NULL;
+    }
+    if (parse_uri(controlURLPath, strlen(controlURLPath), &parsed_url_in) ==
+		    HTTP_SUCCESS) {
         finger = table->serviceList;
         while( finger ) {
             if( finger->controlURL )
